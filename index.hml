<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Malla Interactiva PsicologÃ­a USS (2022-2024)</title>
    <style>
        :root {
            --bg-color: #f4f7f6;
            --primary-color: #00796b; /* Tono verde/azulado acadÃ©mico */
            --secondary-color: #e0f2f1;
            --text-color: #263238;
            --card-bg: #ffffff;
            --approved-bg: #a5d6a7; /* Verde suave aprobado */
            --approved-border: #2e7d32;
            --locked-bg: #eceff1;
            --locked-text: #b0bec5;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        h1 {
            text-align: center;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .controls {
            text-align: center;
            margin-bottom: 20px;
        }

        button.reset-btn {
            background-color: #d32f2f;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }

        button.reset-btn:hover {
            background-color: #b71c1c;
        }

        /* Contenedor principal con scroll horizontal */
        .malla-container {
            display: flex;
            overflow-x: auto;
            gap: 15px;
            padding-bottom: 20px;
            scrollbar-width: thin;
        }

        /* Columna por semestre */
        .semestre-col {
            min-width: 200px;
            max-width: 200px;
            background: #fff;
            border-radius: 8px;
            padding: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .semestre-header {
            text-align: center;
            font-weight: bold;
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 5px;
            margin-bottom: 5px;
            text-transform: uppercase;
            font-size: 0.9em;
        }

        /* Tarjeta de Asignatura */
        .ramo {
            background-color: var(--card-bg);
            border: 1px solid #cfd8dc;
            border-radius: 6px;
            padding: 10px;
            cursor: pointer;
            position: relative;
            transition: all 0.2s ease;
            font-size: 0.85em;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 60px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }

        .ramo:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* Estados */
        .ramo.approved {
            background-color: var(--approved-bg);
            border-color: var(--approved-border);
            color: #1b5e20;
            font-weight: bold;
        }

        .ramo.locked {
            background-color: var(--locked-bg);
            color: var(--locked-text);
            cursor: not-allowed;
            border-style: dashed;
        }

        .ramo.locked:hover {
            transform: none;
            box-shadow: none;
        }

        /* Tooltip personalizado */
        .ramo[data-tooltip]:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: #333;
            color: #fff;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 12px;
            white-space: pre-wrap;
            width: 150px;
            text-align: center;
            z-index: 10;
            pointer-events: none;
            opacity: 0;
            animation: fadeIn 0.2s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; margin-bottom: 5px; }
        }

        .progress-bar-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            margin-bottom: 20px;
            height: 20px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            width: 0%;
            transition: width 0.3s ease;
            text-align: center;
            color: white;
            font-size: 12px;
            line-height: 20px;
        }

        /* Leyenda de Ciclos */
        .legend {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
            font-size: 0.8em;
            color: #555;
        }
        .legend span { display: flex; align-items: center; gap: 5px; }
        .dot { width: 10px; height: 10px; border-radius: 50%; display: inline-block; }
    </style>
</head>
<body>

    <h1>Malla PsicologÃ­a USS (Plan 2022)</h1>
    
    <div class="controls">
        <p>Haz clic en las materias para marcarlas como aprobadas. Las materias bloqueadas (candado) requieren prerrequisitos.</p>
        <div class="progress-bar-container">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>
        <button class="reset-btn" onclick="resetMalla()">Reiniciar Progreso</button>
    </div>

    <div class="legend">
        <span><div class="dot" style="background: white; border: 1px solid #ccc;"></div> Disponible</span>
        <span><div class="dot" style="background: #a5d6a7;"></div> Aprobado</span>
        <span><div class="dot" style="background: #eceff1; border: 1px dashed #ccc;"></div> Bloqueado</span>
    </div>

    <div class="malla-container" id="mallaGrid">
        </div>

<script>
    // DATOS DE LA MALLA
    // Basado en el PDF proporcionado.
    // IMPORTANTE: Los prerrequisitos ('req') han sido inferidos por lÃ³gica estÃ¡ndar (I -> II)
    // ya que el PDF no muestra flechas explÃ­citas.
    const asignaturas = [
        // SEMESTRE 1 [cite: 14]
        { id: 's1_1', sem: 1, name: 'Estrategias para el Aprendizaje', req: [] },
        { id: 's1_2', sem: 1, name: 'Fundamentos BiolÃ³gicos del Comp.', req: [] },
        { id: 's1_3', sem: 1, name: 'Fundamentos FilosÃ³ficos', req: [] },
        { id: 's1_4', sem: 1, name: 'EvoluciÃ³n HistÃ³rica de la Ps.', req: [] },
        { id: 's1_5', sem: 1, name: 'Procesos Cognitivos', req: [] },
        { id: 's1_6', sem: 1, name: 'Taller de ComunicaciÃ³n', req: [] },

        // SEMESTRE 2 [cite: 14]
        { id: 's2_1', sem: 2, name: 'Ã‰tica', req: [] },
        { id: 's2_2', sem: 2, name: 'NeuropsicologÃ­a', req: ['s1_2'] }, // Inferencia: Requiere Bases Bio
        { id: 's2_3', sem: 2, name: 'Fund. SocioantropolÃ³gicos', req: [] },
        { id: 's2_4', sem: 2, name: 'Intro. a la InvestigaciÃ³n', req: [] },
        { id: 's2_5', sem: 2, name: 'Procesos Afectivos', req: [] },
        { id: 's2_6', sem: 2, name: 'Taller de Trabajo Grupal', req: ['s1_6'] }, // Inferencia: Requiere ComunicaciÃ³n
        { id: 's2_7', sem: 2, name: 'AntropologÃ­a', req: [] },

        // SEMESTRE 3 [cite: 15, 39, 41, 51]
        { id: 's3_1', sem: 3, name: 'PsicologÃ­a Social I', req: ['s2_3'] }, // Inferencia
        { id: 's3_2', sem: 3, name: 'TeorÃ­as PsicolÃ³gicas I', req: ['s1_4'] }, // Inferencia: Req Historia
        { id: 's3_3', sem: 3, name: 'PsicologÃ­a Evolutiva I', req: [] },
        { id: 's3_4', sem: 3, name: 'MetodologÃ­a de la Inv.', req: ['s2_4'] }, // Req Intro Inv
        { id: 's3_5', sem: 3, name: 'Psic. de la Personalidad', req: [] }, // [cite: 60]
        { id: 's3_6', sem: 3, name: 'Taller de Entrevista', req: ['s2_6'] }, // [cite: 61]

        // SEMESTRE 4 [cite: 16, 40, 42, 52]
        { id: 's4_1', sem: 4, name: 'PsicologÃ­a Social II', req: ['s3_1'] },
        { id: 's4_2', sem: 4, name: 'TeorÃ­as PsicolÃ³gicas II', req: ['s3_2'] },
        { id: 's4_3', sem: 4, name: 'PsicologÃ­a Evolutiva II', req: ['s3_3'] },
        { id: 's4_4', sem: 4, name: 'AnÃ¡lisis Datos Cuantitativos', req: ['s3_4'] }, // [cite: 62]
        { id: 's4_5', sem: 4, name: 'PsicopatologÃ­a General', req: ['s3_5'] }, // [cite: 63]
        { id: 's4_6', sem: 4, name: 'Eval. PsicolÃ³gica Cognitiva', req: ['s1_5'] }, // [cite: 64]

        // SEMESTRE 5 [cite: 17, 43, 44, 53]
        { id: 's5_1', sem: 5, name: 'Intro. Psicoterapia SistÃ©mica', req: ['s4_2'] },
        { id: 's5_2', sem: 5, name: 'Intro. Psicoterapia Humanista', req: ['s4_2'] },
        { id: 's5_3', sem: 5, name: 'Psicopato. Infanto-Juvenil', req: ['s4_5', 's4_3'] },
        { id: 's5_4', sem: 5, name: 'Comportamiento Organizacional', req: ['s4_1'] }, // [cite: 55]
        { id: 's5_5', sem: 5, name: 'AnÃ¡lisis Datos Cualitativos', req: ['s4_4'] }, // [cite: 65]
        { id: 's5_6', sem: 5, name: 'PolÃ­ticas PÃºblicas', req: [] }, // [cite: 66]

        // SEMESTRE 6 [cite: 18, 33, 34, 54]
        { id: 's6_1', sem: 6, name: 'Intro. Psicoterapia PsicoanalÃ­tica', req: ['s4_2'] },
        { id: 's6_2', sem: 6, name: 'Intro. Psicoterapia Cognitiva', req: ['s4_2'] },
        { id: 's6_3', sem: 6, name: 'PsicopatologÃ­a Adulto', req: ['s4_5'] },
        { id: 's6_4', sem: 6, name: 'GestiÃ³n de Personas', req: ['s5_4'] }, // [cite: 56]
        { id: 's6_5', sem: 6, name: 'Taller Persona del PsicÃ³logo', req: [] }, // [cite: 67]
        { id: 's6_6', sem: 6, name: 'Eval. PsicolÃ³gica Personalidad', req: ['s3_5'] }, // [cite: 68]

        // SEMESTRE 7 [cite: 19, 35, 45, 57]
        { id: 's7_1', sem: 7, name: 'Electivo DiseÃ±o e IntervenciÃ³n I', req: [] },
        { id: 's7_2', sem: 7, name: 'Electivo DiseÃ±o e IntervenciÃ³n II', req: [] }, // [cite: 45]
        { id: 's7_3', sem: 7, name: 'Factores Ps. en EducaciÃ³n', req: ['s4_3'] }, // [cite: 69]
        { id: 's7_4', sem: 7, name: 'Problemas Psicosociales', req: ['s4_1'] }, // [cite: 70]
        { id: 's7_5', sem: 7, name: 'Eval. PsicolÃ³gica Integrada', req: ['s6_6', 's4_6'] }, // [cite: 68]
        { id: 's7_6', sem: 7, name: 'FormulaciÃ³n Proyectos Sociales', req: [] }, // [cite: 67]

        // SEMESTRE 8 [cite: 20, 28-32, 71-74]
        { id: 's8_1', sem: 8, name: 'Electivo DiseÃ±o en Contextos III', req: [] }, // [cite: 74]
        { id: 's8_2', sem: 8, name: 'Electivo FormaciÃ³n Integral I', req: [] }, // [cite: 24, 29]
        { id: 's8_3', sem: 8, name: 'GestiÃ³n Escolar', req: ['s7_3'] }, // [cite: 72]
        { id: 's8_4', sem: 8, name: 'PsicologÃ­a Comunitaria', req: ['s7_4'] }, // [cite: 73]
        { id: 's8_5', sem: 8, name: 'IntegraciÃ³n en PsicologÃ­a', req: [] }, // [cite: 71]

        // SEMESTRE 9 [cite: 21, 58, 75, 77]
        { id: 's9_1', sem: 9, name: 'PrÃ¡ctica Profesional', req: ['s7_5', 's6_5'] }, // Normalmente requiere todo lo anterior
        { id: 's9_2', sem: 9, name: 'Electivo EspecializaciÃ³n I', req: [] },
        { id: 's9_3', sem: 9, name: 'Proyecto de InvestigaciÃ³n', req: ['s5_5', 's4_4'] },
        { id: 's9_4', sem: 9, name: 'Electivo FormaciÃ³n Integral II', req: [] },

        // SEMESTRE 10 [cite: 22, 78, 79]
        { id: 's10_1', sem: 10, name: 'Seminario de InvestigaciÃ³n', req: ['s9_3'] },
        { id: 's10_2', sem: 10, name: 'Electivo EspecializaciÃ³n II', req: [] },
        { id: 's10_3', sem: 10, name: 'Electivo FormaciÃ³n Integral III', req: [] }
    ];

    // ESTADO DE LA APLICACIÃ“N
    let aprobadas = new Set();

    // INICIALIZACIÃ“N
    document.addEventListener('DOMContentLoaded', () => {
        loadProgress();
        renderMalla();
        updateStats();
    });

    function renderMalla() {
        const grid = document.getElementById('mallaGrid');
        grid.innerHTML = '';

        // Crear 10 columnas
        for (let i = 1; i <= 10; i++) {
            const col = document.createElement('div');
            col.className = 'semestre-col';
            
            const header = document.createElement('div');
            header.className = 'semestre-header';
            header.innerText = `Semestre ${i}`;
            col.appendChild(header);

            // Filtrar ramos de este semestre
            const ramosSemestre = asignaturas.filter(r => r.sem === i);

            ramosSemestre.forEach(ramo => {
                const card = document.createElement('div');
                card.className = 'ramo';
                card.id = ramo.id;
                card.innerText = ramo.name;
                
                // Evento Click
                card.onclick = () => toggleRamo(ramo.id);

                col.appendChild(card);
            });

            grid.appendChild(col);
        }
        updateVisualState();
    }

    function toggleRamo(id) {
        if (isLocked(id)) return; // No hacer nada si estÃ¡ bloqueado

        if (aprobadas.has(id)) {
            aprobadas.delete(id);
            // Al desmarcar, verificar si bloquea a otros en cadena (recursivo implÃ­cito al actualizar visual)
        } else {
            aprobadas.add(id);
        }
        
        saveProgress();
        updateVisualState();
        updateStats();
    }

    function isLocked(id) {
        const ramo = asignaturas.find(r => r.id === id);
        if (!ramo.req || ramo.req.length === 0) return false;
        
        // EstÃ¡ bloqueado si AL MENOS UNO de sus requisitos NO estÃ¡ aprobado
        return ramo.req.some(reqId => !aprobadas.has(reqId));
    }

    function getMissingReqsNames(id) {
        const ramo = asignaturas.find(r => r.id === id);
        const missingIds = ramo.req.filter(reqId => !aprobadas.has(reqId));
        return missingIds.map(mid => {
            const reqRamo = asignaturas.find(r => r.id === mid);
            return reqRamo ? reqRamo.name : mid;
        }).join(', ');
    }

    function updateVisualState() {
        asignaturas.forEach(ramo => {
            const el = document.getElementById(ramo.id);
            if (!el) return;

            // Reset clases
            el.className = 'ramo';
            el.removeAttribute('data-tooltip');

            if (aprobadas.has(ramo.id)) {
                el.classList.add('approved');
                el.innerText = `âœ“ ${ramo.name}`;
            } else {
                if (isLocked(ramo.id)) {
                    el.classList.add('locked');
                    el.innerText = `ðŸ”’ ${ramo.name}`;
                    const missing = getMissingReqsNames(ramo.id);
                    el.setAttribute('data-tooltip', `Falta aprobar:\n${missing}`);
                } else {
                    // Disponible
                    el.innerText = ramo.name;
                }
            }
        });
    }

    function updateStats() {
        const total = asignaturas.length;
        const count = aprobadas.size;
        const percentage = Math.round((count / total) * 100);
        
        const bar = document.getElementById('progressBar');
        bar.style.width = `${percentage}%`;
        bar.innerText = `${percentage}% Completado`;
    }

    // PERSISTENCIA (LOCALSTORAGE)
    function saveProgress() {
        localStorage.setItem('malla_psico_uss_2022_v1', JSON.stringify([...aprobadas]));
    }

    function loadProgress() {
        const saved = localStorage.getItem('malla_psico_uss_2022_v1');
        if (saved) {
            aprobadas = new Set(JSON.parse(saved));
        }
    }

    function resetMalla() {
        if(confirm("Â¿EstÃ¡s seguro de borrar todo el progreso?")) {
            aprobadas.clear();
            saveProgress();
            updateVisualState();
            updateStats();
        }
    }
</script>

</body>
</html>
